# ===========================================
# Network features for WiFi, Ethernet, and NFS
# ===========================================
# The base PieJam kernel has networking disabled (audio-only appliance).
# This fragment enables the full TCP/IP stack, WiFi, Ethernet, and NFS server.

# --- Module support (needed for firmware-loading WiFi drivers) ---
CONFIG_MODULES=y
CONFIG_MODULE_UNLOAD=y

# --- TCP/IP Networking Stack ---
CONFIG_INET=y
CONFIG_IP_MULTICAST=y
CONFIG_IP_PNP=y
CONFIG_IP_PNP_DHCP=y
CONFIG_TCP_CONG_CUBIC=y
CONFIG_DEFAULT_TCP_CONG="cubic"
CONFIG_IPV6=y
CONFIG_NETFILTER=y

# --- Ethernet (wired fallback) ---
CONFIG_NETDEVICES=y
CONFIG_ETHERNET=y
CONFIG_NET_VENDOR_BROADCOM=y
CONFIG_BCMGENET=y
CONFIG_MACB=y

# --- Wireless Subsystem (full dependency chain) ---
CONFIG_WIRELESS=y
CONFIG_WEXT_CORE=y
CONFIG_WEXT_PROC=y
CONFIG_CFG80211=m
# CONFIG_CFG80211_REQUIRE_SIGNED_REGDB is not set
CONFIG_CFG80211_DEFAULT_PS=y
CONFIG_CFG80211_CRDA_SUPPORT=y
CONFIG_MAC80211=m
CONFIG_MAC80211_HAS_RC=y
CONFIG_MAC80211_RC_MINSTREL=y
CONFIG_MAC80211_RC_DEFAULT_MINSTREL=y
CONFIG_MAC80211_RC_DEFAULT="minstrel_ht"
CONFIG_RFKILL=y

# --- Broadcom WiFi Driver (Pi 3/4/5 onboard WiFi) ---
CONFIG_WLAN=y
CONFIG_WLAN_VENDOR_BROADCOM=y
CONFIG_BRCMUTIL=m
CONFIG_BRCMFMAC=m
CONFIG_BRCMFMAC_SDIO=y

# --- NFS Server ---
CONFIG_NETWORK_FILESYSTEMS=y
CONFIG_NFSD=m
CONFIG_NFSD_V3=y
CONFIG_NFSD_V4=y
CONFIG_EXPORTFS=y
CONFIG_LOCKD=m
CONFIG_NFS_ACL_SUPPORT=m
CONFIG_SUNRPC=m
CONFIG_SUNRPC_GSS=m
